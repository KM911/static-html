---
title: nodejs
date: 2023-01-12 14:17:43
tags:
categories:
---

# ç¯å¢ƒæ­å»º

è¿™é‡Œä¸è§£é‡Šäº†

# hello world

åœ¨æˆ‘çœ‹æ¥ è¿™ä¸ªæ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„hello world in nodejs â€“å®ƒè§£é‡Šäº† æˆ‘ä»¬çš„nodejsåˆ°åº•æ˜¯åšä»€ä¹ˆçš„ è€Œä¸æ˜¯ä½ çš„npmç¯å¢ƒ 

åˆ›å»ºä¸€ä¸ªserver.jsæ–‡ä»¶ å†™å…¥ä¸‹é¢çš„ä»£ç 

```js
const http = require("http");

const server = http.createServer((request, respond) => {
    console.log("hello world");
    respond.end("hello world");
})
server.listen(3000);
```

åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€cmd or powershell è¾“å…¥ `node server.js`

ç„¶åæ‰“å¼€æµè§ˆå™¨ è¾“å…¥ä¸‹é¢çš„ç½‘å€ `localhost:3000/`

å°±å¯ä»¥çœ‹åˆ° æˆ‘ä»¬çš„cmdç•Œé¢ä¸­ è¾“å‡ºäº†`hello world` æµè§ˆå™¨æ˜¾ç¤ºäº† hello world (ä¸è¿‡æ˜¯åœ¨å±å¹•çš„å·¦ä¸Šè§’ å¹¶ä¸”å­—ä½“æœ‰äº›å°)

## Nodejs

æˆ‘ä»¬ä½¿ç”¨Nodejs æ˜¯å¼€å‘ç½‘é¡µçš„åç«¯ (è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ä»£ç ) 

ç”¨äºå¤„ç†æˆ‘ä»¬æµè§ˆå™¨çš„å„ç§è¯·æ±‚ æ¯”å¦‚http æ˜¯åè®® getæ˜¯åè®®ä¸­çš„method å§

æ¯”å¦‚ http://zuoge.online å°±æ˜¯æµè§ˆå™¨å‘é€ä¸€ä¸ªgetè¯·æ±‚åˆ°å…¶å¯¹åº”çš„æœåŠ¡å™¨ä¸Š æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚å å°±ä¼šè¿”å›ä¿¡æ¯ æ˜¾ç¤ºåœ¨æˆ‘ä»¬çš„æµè§ˆå™¨ä¸­ å¯ä»¥æ˜¯ç½‘é¡µhtml æˆ–è€… æ•°æ® 

## è§£ærequestè¯·æ±‚

æˆ‘ä»¬çš„æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€äº†httpçš„è¯·æ±‚ å…¶ä¸­åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ æ¯”å¦‚è®¿é—®çš„å…·ä½“ç½‘å€ ä½¿ç”¨çš„è®¾å¤‡ å‘é€è¯·æ±‚çš„ip å¤§ä½“å¦‚å›¾æ‰€ç¤º

```
```

å…¶ä¸­æœ€å…³é”®çš„æ˜¯æˆ‘ä»¬çš„è·¯å¾„è§£æ 

## è·¯ç”±

å†çœ‹ä¸€æ®µä»£ç 

```
const http = require("http");

const server = http.createServer((request, respond) => {
    console.log("hello world");
    respond.end("hello world");
})
server.listen(3000);
```



æˆ‘ä»¬è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ä»£ç 

console.log() åœ¨nodejsçš„è¿è¡Œçª—å£ è¾“å‡º

respond è¿”å›çš„ä¿¡æ¯ å°±æ˜¯æµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„





## è·å–getè¯·æ±‚çš„æ•°æ®



### è§£ærequestä¸­çš„æ•°æ®

> å°†reqä¸­çš„è·¯ç”± è§£æ å°±æ˜¯? åŠå…¶åé¢çš„å†…å®¹
>
> > req.url  
>
> å°†å…¶è§£æä¸ºjson
>
> > json_data = url.parse(req.url,true)
>
> è·å–? åé¢çš„å‚æ•°
>
> > q = json_data.query
>
> æ ¹æ® é”®è·å–å€¼
>
> > value  = q.key



## è·å–postè¯·æ±‚ä¸­çš„æ•°æ®

post æ— æ³•ä»è·¯å¾„ä¸­è·å–å‚æ•°

è¿™é‡Œæˆ‘ä»¬éœ€è¦å…¶ä»–çš„æ–¹æ³•

```js
// å…ˆè¯´jsæ˜¯å¦‚ä½•å‘é€postè¯·æ±‚çš„
let xhr = new XMLHttpRequest();
            xhr.open("POST", "http://localhost:3000/?action=add_article", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded")
            xhr.send(JSON.stringify({
                "author": document.getElementById("author").value,
                "title": document.getElementById("title").value,
                "content": document.getElementById("content").value
            }));
            xhr.onreadystatechange = function () {
```

æˆ‘ä»¬æ˜¯å¦‚ä½•æ¥å—postè¯·æ±‚çš„





## åˆ©ç”¨respondè¿”å›æ•°æ®

### è®¾ç½®çŠ¶æ€ä¿¡æ¯

## æ–‡ä»¶è¯»å–

fs.readFileSync

è¿™æ˜¯åŒæ­¥çš„è¯»å– æ–¹å¼ é¿å…å‘é€ç©ºçš„ä¿¡æ¯å›å»

å¯ä»¥å¯¹æ™®é€šæ–‡ä»¶è¿›è¡Œå‘é€ ä½†æ˜¯å¯¹äºå›¾ç‰‡ è¯¥æ€ä¹ˆåŠå‘¢?



## æ–‡ä»¶ä¿å­˜ 



## è·¯å¾„é‡æ–°å®šå‘é—®é¢˜

æœ‰äº›è·¯å¾„çš„è·å– ä¼šå¯¼è‡´ä¹‹å‰çš„è·¯å¾„æ— æ•ˆ

ç›®å‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ç”¨ç›¸å¯¹è·¯å¾„å†™ å¹¶ä¸”ä¿è¯ä¸è¦å‡ºç°è·¯å¾„æ··ä¹± è¿™é‡Œå°±æ˜¯è‡ªå·±çš„ä»£ç å†™å¾—çƒ‚å•Š ä½ è‡ªå·±æƒ³æƒ³å•Š ä½ å¦‚æœé‡å®šå‘æœ‰é—®é¢˜ ä¸å°±æ˜¯ç›´æ¥ggäº†å—? 



> é‡å®šå‘é—®é¢˜ 
>
> > './é‡æ–°å®šå‘æ–‡ä»¶å¤¹/QQå›¾ç‰‡20221004203229.jpg'

## è¿æ¥æ•°æ®åº“

éœ€è¦ä¸€ä¸ªæ’ä»¶

```
npm install mysql --save è¿˜æ˜¯æ”¾åˆ°æˆ‘ä»¬çš„å·¥ä½œç¯å¢ƒé‡Œé¢å§
```

è¿™é‡Œä¸å†™å¯¹äºæ•°æ®åº“çš„åŸºæœ¬æ“ä½œ è€Œæ˜¯å†™ å¯¹äºæ“ä½œçš„è¦ç‚¹ æ¯”å¦‚è¯´ å¦‚ä½•å» 



### æ³¨å†Œ å’Œ ç™»å½•

**æ³¨å†Œæ–¹é¢**

* æœ‰ä¸åŒçš„è´¦å· æ£€æŸ¥è´¦å·æ˜¯å¦ç›¸åŒâ€“è´¦å·å·²ç»è¢«æ³¨å†Œäº†
* å…ˆä¸ç®¡è¿™äº›å§ æ¯”å¦‚æ‰¾å›ä»€ä¹ˆçš„



**ç™»å½•**

user -> pwd -> yes è¿”å›ä¸¤ä¸ªä¸åŒçš„ä¿¡æ¯

è´¦å·ä¸å­˜åœ¨ -> å¯†ç é”™è¯¯ -> ç™»å½•æˆåŠŸ

ç™»å½•å‡½æ•°

```js
function login(respond, respond_data) {
    // 1. è·å–åˆ°ç”¨æˆ·åå’Œå¯†ç 
    // 2. åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
    // 3. å¦‚æœå­˜åœ¨å°±åˆ¤æ–­å¯†ç æ˜¯å¦æ­£ç¡®
    // 4. å¦‚æœå¯†ç æ­£ç¡®å°±è¿”å›ç™»å½•æˆåŠŸ
    // 5. å¦‚æœå¯†ç é”™è¯¯å°±è¿”å›å¯†ç é”™è¯¯
    // 6. å¦‚æœç”¨æˆ·åä¸å­˜åœ¨å°±è¿”å›ç”¨æˆ·åä¸å­˜åœ¨
    db.query("select * from user_info where username = ?", [respond_data.username], function (err, result) {
        if (err) {
            console.log(err)
        }
        else {
            if (result.length == 0) {
                // è¯´æ˜æ²¡æœ‰ç›¸åŒçš„ç”¨æˆ·
                console.log("ç”¨æˆ·åä¸å­˜åœ¨")
                respond.writeHeader(200, { "Content-Type": "application/json;charset=utf-8" })
                respond.end(JSON.stringify({ "code": 400, "msg": "ç”¨æˆ·åä¸å­˜åœ¨" }))
            }
            else {
                // è¯´æ˜æœ‰ç›¸åŒçš„ç”¨æˆ·
                if (result[0].password == respond_data.password) {
                    // è¯´æ˜å¯†ç æ­£ç¡®
                    console.log("ç™»å½•æˆåŠŸ")
                    respond.writeHeader(200, { "Content-Type": "application/json;charset=utf-8" })
                    respond.end(JSON.stringify({ "code": 200, "msg": "ç™»å½•æˆåŠŸ" }))
                }
                else {
                    // è¯´æ˜å¯†ç é”™è¯¯
                    console.log("å¯†ç æ˜¯ " + result[0].password)
                    console.log("é”™è¯¯çš„å¯†ç æ˜¯ " + respond_data.password)
                    console.log("å¯†ç é”™è¯¯")
                    respond.writeHeader(200, { "Content-Type": "application/json;charset=utf-8" })
                    respond.end(JSON.stringify({ "code": 400, "msg": "å¯†ç é”™è¯¯" }))
                }
            }
        }
    })
}
```



## è§£å†³è·¨åŸŸé—®é¢˜

æˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡ç«¯ è®¾ç½®å›å¤ä¿¡æ¯çš„å¤´ä¸º

```
respond.setHeader("Access-Control-Allow-Origin", "*");
```

å°±ç®—ä¸è®¾ç½® ä¿¡æ¯çŠ¶æ€ç  éƒ½æ˜¯å¯ä»¥çš„



## ç¼–å†™è‡ªå·±çš„package

è¿™æ ·å¯ä»¥åŒ–ç®€æˆ‘ä»¬çš„ 

åˆ©ç”¨moudle.export{

å‡½æ•°å,}





# CMSé¡¹ç›®

content management system å†…å®¹ç®¡ç†ç³»ç»Ÿ

æˆ‘ä»¬çš„å›¾åºŠ ç™¾åº¦ç½‘ç›˜ å…¶å®éƒ½æ˜¯ä¸€ä¸ªCMSç³»ç»Ÿ 

## NP è¿™é‡Œæ˜¯å›¾åºŠ æ‰€ä»¥æ˜¯å…¬å¼€çš„

åˆ†ææˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ 

index å°†ä¸Šä¼ å›¾åƒ å’Œ æ˜¾ç¤ºå›¾åƒçš„é¡µé¢ èšåˆåˆ°ä¸€èµ· 

é¦–å…ˆæ˜¯ä¸€ä¸ª top å¯¼èˆªæ  å¥½å§ 

å…¶å®è¿™é‡Œå°±å·²ç»ğŸ†—äº† logo æ˜¯



æˆ‘ä»¬éœ€è¦ä¸€ä¸ªlog åˆ†åˆ«æ˜¯ico webpä¹‹ç±»çš„åœ°æ–¹ 

| logæ˜¾ç¤ºéƒ¨åˆ†    | ä¸Šä¼ å›¾ç‰‡                                             |
| -------------- | ---------------------------------------------------- |
| å›¾åºŠçš„æ˜¾ç¤ºéƒ¨åˆ† | è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨keep-alive ä¸€ä¸ªå¾ˆé•¿çš„æ—¶é—´ ä¸ä¼šå¾ˆå¿«çš„æ›´æ–° |

è¿™é‡Œç›´æ¥æ˜¾ç¤º10å¼ å›¾ç‰‡ æ˜¾ç¤ºæ–‡å­— å’Œ å›¾ç‰‡çš„å†…å®¹

class = shower

å¦‚ä½•å¯¹äºå›¾åƒ è¿˜æ˜¯åº”è¯¥ä½¿ç”¨å°±æ˜¯ new 2 old çš„æ’åˆ—æ–¹å¼ å›¾ç‰‡çš„å¤§å°æ˜¯ç»Ÿä¸€çš„ è¿™æ ·è®©å¤§å®¶éƒ½å¯ä»¥çœ‹è§ æˆ‘ä»¬çš„ç¼“å­˜çš„ä¿¡æ¯ å°±æ˜¯è¿˜æ˜¯ä¸é”™çš„ list



## è¿™é‡Œå¼€å§‹æˆ‘ä»¬çš„ä¸Šä¼ å¤´åƒæ–‡ä»¶ä½œä¸ºè¯•ç‚¹

å¦‚ä½•å†™ä¸€ä¸ªåˆç†çš„å¼€å‘ä¼åˆ’ 

æ¸…æ™°æ˜ç¡®çš„é¡¹ç›®æ–‡æ¡£ å“

å…¶å®å°±æ˜¯ä¸€ä¸ª caves ä¸æ˜¯å¾ˆéš¾çš„å§ 

æ‰€ä»¥æˆ‘ä»¬çœ‹çœ‹ node å’Œ å…±

ä½¿ç”¨redis è¿›è¡Œä¼˜åŒ– è¿™é‡Œæ˜¯ è¿›è¡Œé”®å€¼å¯¹çš„ å­˜å‚¨ 

ä¸å¯¹ å¼€å§‹åŠ è½½ ç„¶åå°±å¯ä»¥äº† 

æ¶ˆæ¯é˜Ÿåˆ— ä½¿ç”¨ redis å®ç°å°±å¥½äº†è¿™ä¸ªå…¶å®ä¼°è®¡æ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯éš¾åº¦ ä»Šå¹´çš„å¯’å‡é‡Œ ç­‰ç­‰å•Š æˆ‘æ˜¯ä¸æ˜¯å°±æ˜¯ç»å†è¿‡è¿™ä¸ª è¿™ä¹ˆåˆåˆ° å¯’å‡äº† å…¶å®æˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢è¿™ä¸ªä¸œè¥¿ å“

  

## å…¶å®æˆ‘çš„é—®é¢˜æœ‰å¾ˆå¤š ç¬¬ä¸€æ˜¯ 

nodejs çœŸçš„ä¸è¡Œå—? æˆ‘æ„Ÿè§‰è¿˜å¯ä»¥å•Š  

